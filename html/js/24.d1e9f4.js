webpackJsonp([24],{1459:function(t,e,o){t.exports=o.p+"image/icon_point.0cd860.png"},1896:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o(1897),a=o.n(n);for(var i in n)"default"!==i&&function(t){o.d(e,t,function(){return n[t]})}(i);e.default=a.a},1897:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o(461),a=(function(t){t&&t.__esModule}(n),o(2494));e.default={name:"attendance",data:function(){return{time:"09:41",duty:"上班打卡",inRange:!0,address:"",timer:""}},created:function(){var t=this,e={para:"userId="+window.localStorage.userId};window.serverUrl;this.$http.post("/wgh/app/app_userStateCheck.action",e).then(function(e){console.log(e),"0"==e.attendStatus?t.duty="上班打卡":(e.attendStatus,t.duty="下班打卡")})},mounted:function(){this._getLocation(),this.timer=setInterval(this._clock,1e3)},beforeDestroy:function(){clearInterval(this.timer)},methods:{showMapWithoutPosition:function(){},_getLocation:function(){var t=this;navigator.geolocation?navigator.geolocation.getCurrentPosition(this._showPosition,function(e){switch(console.log("进入定位错误回调"),console.log(e.message),e.code){case e.PERMISSION_DENIED:console.log("用户拒绝对获取地理位置的请求。");break;case e.POSITION_UNAVAILABLE:console.log("位置信息是不可用的。");break;case e.TIMEOUT:console.log("请求用户地理位置超时。");break;case e.UNKNOWN_ERROR:console.log("未知错误。")}setTimeout(t._getLocation,500)},{enableHighAccuracy:!1,timeout:1e4,maximumAge:0}):alert("是否开启了GPS功能")},_showPosition:function(t){var e=this;if(isNull(t.coords.longitude))toast("坐标为空,请重新定位");else{console.log("定位成功，进入_showPosition"),window.longitude=t.coords.longitude,window.latitude=t.coords.latitude,window.choiceLongitude=t.coords.longitude,window.choiceLatitude=t.coords.latitude;var o=new BMap.Point(window.longitude,window.latitude),n=[];n.push(o);(new BMap.Convertor).translate(n,1,5,function(t){if(0===t.status){(new BMap.Geocoder).getLocation(t.points[0],function(t){return e._searchResult(t)})}})}},_searchResult:function(t){console.log("_searchResult: "+t.address),window.localStorage.mapAddress=t.address,this.address=t.address,isNull(window.setIdMapAddress)||$("#"+window.setIdMapAddress).html(window.localStorage.mapAddress),this._refreshMap()},_refreshMap:function(){console.log("进入_refreshMap"),console.log("当前longitude："+window.longitude),console.log("当前latitude："+window.latitude);var t=void 0;t=new T.Map("attendance_map"),t.centerAndZoom(new T.LngLat(window.longitude||120.00623,window.latitude||32.0444),16);var e=new T.Icon({iconUrl:o(1459),iconSize:new T.Point(19,27),iconAnchor:new T.Point(10,25)}),n=new T.Marker(new T.LngLat(window.longitude,window.latitude),{icon:e});t.clearOverLays(),t.addOverLay(n);var a=new T.Circle(new T.LngLat(window.longitude,window.latitude),200,{color:"blue",weight:1,opacity:.5,fillColor:"#666666",fillOpacity:.3,lineStyle:"solid"});t.addOverLay(a)},_clock:function(){var t=new Date,e=(t.getFullYear(),t.getMonth(),t.getDate(),t.getDay(),t.getHours().toString().padStart(2,"0")),o=t.getMinutes().toString().padStart(2,"0");t.getSeconds();this.time=e+":"+o},attend:function(){console.log("点击了打卡按钮");var t="上班打卡"===this.duty?1:2;this.submit(t)},submit:function(t){var e=this;this.$http.post("wgh/app/app_userCheck.action",{token:localStorage.getItem("token"),address:this.address,attendStatus:t,longitude:window.longitude,latitude:window.latitude}).then(function(t){console.log(t),0==t.code?(toast(t.message),"1"==t.attendStatus?(e.duty="上班打卡",console.log("服务器地址： "+a.proxy[0].target),jsict.logininfo.save(function(t){console.log(t)},function(t){console.error(t)},localStorage.getItem("token"),a.proxy[0].target),jsict.logininfo.start(function(t){console.log(t)},function(t){console.error(t)})):"2"==t.attendStatus&&(e.duty="下班打卡",jsict.logininfo.stop(function(t){console.log(t)},function(t){console.error(t)})),e.$router.back()):toast(t.message)})}}}},1898:function(t,e){},2492:function(t,e,o){"use strict";var n=o(2493);o.d(e,"a",function(){return n.a}),o.d(e,"b",function(){return n.b})},2493:function(t,e,o){"use strict";o.d(e,"a",function(){return n}),o.d(e,"b",function(){return a});var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"attendance"},[o("tk-header",[t._v("上下班考勤")]),t._v(" "),o("div",{staticClass:"attendance-content"},[t._m(0),t._v(" "),o("div",{staticClass:"attend-btn-wrapper"},[o("div",{staticClass:"attend-btn"},[o("div",{staticClass:"circle-wrapper",on:{click:t.attend}},[o("div",{staticClass:"attendance-time"},[t._v(t._s(t.time))]),t._v(" "),o("div",{staticClass:"attendance-duty"},[t._v(t._s(t.duty))])])])])])],1)},a=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"map-wrapper"},[o("div",{staticClass:"attendance-map",attrs:{id:"attendance_map"}})])}]},2494:function(t,e,o){"use strict";t.exports={rem:16,auto_open_browser:!0,postCss:!0,entry:"index",commonJs:"base",port:8088,static:!0,compress:!1,proxy:[{api:["/wgh"],target:"http://10.1.163.172:8087"},{api:["/api"],target:"http://localhost:3333"},{api:["/zhzf"],target:"http://10.1.163.172:8085"},{api:["/ump"],target:"http://10.1.163.172:8081"}]}},2495:function(t,e,o){"use strict";var n=o(1898),a=o.n(n);a.a},616:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o(2492),a=o(1896);for(var i in a)"default"!==i&&function(t){o.d(e,t,function(){return a[t]})}(i);var s=(o(2495),o(0)),r=Object(s.a)(a.default,n.a,n.b,!1,null,"66f379d0",null);e.default=r.exports}});